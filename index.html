<!DOCTYPE html>
<html>
  <head>
    <title>Minimal Black & White Lots Map</title>
    <style>
      #map {
        height: 100vh;
        width: 100%;
        margin: 0;
        padding: 0;
        background-color: white;
}
      }
      body {
        margin: 0;
      }
    </style>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCBTROq6LuvF_IE1r46-T4AeTSV-0d7my8"></script>
    <script>
      function initMap() {
        const blackAndWhiteStyle = [
          {
            "elementType": "geometry",
            "stylers": [{ "color": "#ffffff" }]
          },
          {
            "elementType": "labels",
            "stylers": [{ "visibility": "off" }]
          },
          {
            "featureType": "road",
            "elementType": "geometry",
            "stylers": [{ "color": "#000000" }]
          },
          {
            "featureType": "road.arterial",
            "elementType": "geometry",
            "stylers": [{ "color": "#000000" }]
          },
          {
            "featureType": "road.highway",
            "elementType": "geometry",
            "stylers": [{ "color": "#000000" }]
          },
          {
            "featureType": "road.local",
            "elementType": "geometry",
            "stylers": [{ "color": "#000000" }]
          },
          {
            "featureType": "water",
            "elementType": "geometry",
            "stylers": [{ "color": "#ffffff" }]
          },
          {
            "featureType": "administrative",
            "elementType": "geometry",
            "stylers": [{ "color": "#000000" }]
          }
        ];

        const map = new google.maps.Map(document.getElementById("map"), {
          zoom: 17.9,
          center: { lat: 25.461823, lng: -100.15994 },
          styles: blackAndWhiteStyle,
          mapTypeId: "roadmap"
        });

        fetch('https://lalaland.mx/lots.txt')
          .then(response => response.text())
          .then(text => {
            const lotData = parseLotData(text);
            lotData.forEach((lot) => {
              const polygon = new google.maps.Polygon({
                paths: lot.coords,
                strokeColor: "#ffffff", // white border
                strokeOpacity: 1,
                strokeWeight: 1,
                fillColor: "#000000", // black fill
                fillOpacity: 1,
                geodesic: false,
                map: map,
                zIndex: 1
              });

              const infoWindow = new google.maps.InfoWindow({
                content: lot.name,
                position: lot.coords[0]
              });

              polygon.addListener("click", () => {
                infoWindow.open(map);
              });

              polygon.addListener("mouseover", () => {
                polygon.setOptions({ fillOpacity: 0.9 });
              });

              polygon.addListener("mouseout", () => {
                polygon.setOptions({ fillOpacity: 1 });
              });
            });
          })
          .catch(error => {
            console.error('Error loading or parsing the lot data:', error);
          });
      }

      function parseLotData(text) {
        const lotData = [];
        const lines = text.split("\n");
        let lotCoords = [];
        let lotName = "";

        lines.forEach((line) => {
          const matchLotName = line.match(/^lot\d+/);
          if (matchLotName) {
            if (lotCoords.length > 0) {
              lotData.push({ name: lotName, coords: lotCoords });
            }
            lotName = matchLotName[0];
            lotCoords = [];
          }

          const matchCoordinates = line.match(/lat: ([-\d.]+), lng: ([-\d.]+)/);
          if (matchCoordinates) {
            lotCoords.push({
              lat: parseFloat(matchCoordinates[1]),
              lng: parseFloat(matchCoordinates[2]),
            });
          }
        });

        if (lotCoords.length > 0) {
          lotData.push({ name: lotName, coords: lotCoords });
        }

        return lotData;
      }
    </script>
  </head>
  <body onload="initMap()">
    <div id="map"></div>
  </body>
</html>
